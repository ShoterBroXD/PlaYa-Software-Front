<div class="password-change-container">
    <h2>Cambio de contraseña</h2>
    
    <label>Contraseña Actual</label>
    <div class="input-group">
        <input [type]="showCurrent ? 'text' : 'password'" [(ngModel)]="currentPassword" placeholder="Ingresa tu contraseña actual" />
        <button type="button" (click)="showCurrent = !showCurrent" [attr.aria-label]="showCurrent ? 'Ocultar contraseña' : 'Mostrar contraseña'">
            <img [src]="showCurrent ? 'assets/img/icons/eye-close.svg' : 'assets/img/icons/eye-open.svg'" [alt]="showCurrent ? 'Ocultar contraseña' : 'Mostrar contraseña'">
        </button>
    </div>

    <label>Nueva Contraseña</label>
    <div class="input-group">
        <input [type]="showNew ? 'text' : 'password'" [(ngModel)]="newPassword" (input)="validate()" placeholder="Ingresa tu nueva contraseña" />
        <button type="button" (click)="showNew = !showNew" [attr.aria-label]="showNew ? 'Ocultar contraseña' : 'Mostrar contraseña'">
            <img [src]="showNew ? 'assets/img/icons/eye-close.svg' : 'assets/img/icons/eye-open.svg'" [alt]="showNew ? 'Ocultar contraseña' : 'Mostrar contraseña'">
        </button>
    </div>

    <label>Confirmar Contraseña</label>
    <div class="input-group">
        <input [type]="showConfirm ? 'text' : 'password'" [(ngModel)]="confirmPassword" (input)="validate()" placeholder="Confirma tu nueva contraseña" />
        <button type="button" (click)="showConfirm = !showConfirm" [attr.aria-label]="showConfirm ? 'Ocultar contraseña' : 'Mostrar contraseña'">
            <img [src]="showConfirm ? 'assets/img/icons/eye-close.svg' : 'assets/img/icons/eye-open.svg'" [alt]="showConfirm ? 'Ocultar contraseña' : 'Mostrar contraseña'">
        </button>
    </div>

    <ul class="requirements">
        <li [class.valid]="validations.minLength">✔ Longitud mínima (ej: 8 caracteres).</li>
        <li [class.valid]="validations.match">✔ Debe coincidir con la confirmación.</li>
        <li [class.valid]="validations.uppercase">✔ Mayúsculas.</li>
        <li [class.valid]="validations.lowercase">✔ Minúsculas.</li>
        <li [class.valid]="validations.numbers">✔ Números.</li>
        <li [class.valid]="validations.special">✔ Especiales (#,$,%,..).</li>
    </ul>

    <!-- Mensaje de error -->
    <div *ngIf="errorMessage()" class="alert-error">
        <i class="fas fa-exclamation-circle"></i>
        {{ errorMessage() }}
    </div>

    <!-- Mensaje de éxito -->
    <div *ngIf="successMessage()" class="alert-success">
        <i class="fas fa-check-circle"></i>
        {{ successMessage() }}
    </div>

    <div class="buttons">
        <button class="btn cancel" (click)="cancelar()" [disabled]="loading()">Cancelar</button>
        <button class="btn change" [disabled]="!isValid() || loading()" (click)="cambiarContrasena()">
            <span *ngIf="!loading()">Cambiar</span>
            <span *ngIf="loading()">Cambiando...</span>
        </button>
    </div>
</div>