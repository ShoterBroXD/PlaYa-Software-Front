<div class="library-page">
  <div class="library-header">
    <h1 class="library-title">Tu Biblioteca</h1>
  </div>

  <!-- Tu música -->
  <section class="library-section">
    <h2 class="section-subtitle">Tu música</h2>
    <div *ngIf="loading" class="loading">Cargando tus canciones...</div>
    <div *ngIf="errorMessage" class="error-message">{{ errorMessage }}</div>
    <div class="library-grid" *ngIf="!loading && userSongs && userSongs.length > 0">
      <div class="card-library" *ngFor="let song of userSongs" (click)="playSong(song, userSongs)">
        <img [src]="song.coverURL || '/assets/img/images/img-placeholder.svg'" [alt]="song.title" class="card-img">
        <div class="card-info">
          <div class="info-top">
            <p class="song-title">{{ song.title }}</p>
            <button class="add-btn" (click)="openAddToPlaylistModal($event, song.idSong)" title="Añadir a playlist">
              <i class="fas fa-plus"></i>
            </button>
          </div>
          <p class="song-details">{{ song.artist?.name || 'Artista' }} · {{ song.uploadDate ? (song.uploadDate | date:
            'yyyy') : '2025' }}</p>
        </div>
      </div>
    </div>
    <div *ngIf="!loading && (!userSongs || userSongs.length === 0)" class="empty-state">
      <p>Aún no has subido ninguna canción</p>
      <a [routerLink]="['/upload']" class="btn-upload">Subir música</a>
    </div>
  </section>

  <app-add-to-playlist-modal [isOpen]="isModalOpen" [songIds]="selectedSongIds" (closeModal)="closeModal()"
    (added)="onSongsAdded()"></app-add-to-playlist-modal>
</div>