<div class="payment-container" *ngIf="selectedPlan">
  <h1>Pago de Suscripción Premium</h1>
  <div class="plan-summary">
    <h2>{{ selectedPlan.name }}</h2>
    <p class="price">{{ selectedPlan.price }}</p>
  </div>

  <form [formGroup]="paymentForm" (ngSubmit)="onSubmit()" class="payment-form">
    <div class="form-group">
      <label for="name">Nombre en la Tarjeta *</label>
      <input
        type="text"
        id="name"
        formControlName="name"
        class="form-control"
        [class.error]="name?.invalid && name?.touched"
      />
      <div class="error-message" *ngIf="name?.invalid && name?.touched">
        <span *ngIf="name?.errors?.['required']">El nombre es obligatorio.</span>
      </div>
    </div>

    <div class="form-group">
      <label for="cardNumber">Número de Tarjeta *</label>
      <input
        type="text"
        id="cardNumber"
        formControlName="cardNumber"
        placeholder="1234 5678 9012 3456"
        class="form-control"
        [class.error]="cardNumber?.invalid && cardNumber?.touched"
      />
      <div class="error-message" *ngIf="cardNumber?.invalid && cardNumber?.touched">
        <span *ngIf="cardNumber?.errors?.['required']">El número de tarjeta es obligatorio.</span>
        <span *ngIf="cardNumber?.errors?.['pattern']">Debe ser un número de 16 dígitos.</span>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="expiryDate">Fecha de Expiración *</label>
        <input
          type="text"
          id="expiryDate"
          formControlName="expiryDate"
          placeholder="MM/YY"
          class="form-control"
          [class.error]="expiryDate?.invalid && expiryDate?.touched"
        />
        <div class="error-message" *ngIf="expiryDate?.invalid && expiryDate?.touched">
          <span *ngIf="expiryDate?.errors?.['required']">La fecha es obligatoria.</span>
          <span *ngIf="expiryDate?.errors?.['pattern']">Formato MM/YY.</span>
        </div>
      </div>

      <div class="form-group">
        <label for="cvv">CVV *</label>
        <input
          type="text"
          id="cvv"
          formControlName="cvv"
          placeholder="123"
          class="form-control"
          [class.error]="cvv?.invalid && cvv?.touched"
        />
        <div class="error-message" *ngIf="cvv?.invalid && cvv?.touched">
          <span *ngIf="cvv?.errors?.['required']">El CVV es obligatorio.</span>
          <span *ngIf="cvv?.errors?.['pattern']">Debe ser 3 dígitos.</span>
        </div>
      </div>
    </div>

    <div class="error-message" *ngIf="errorMessage">{{ errorMessage }}</div>

    <div class="form-actions">
      <button type="button" (click)="onCancel()" class="btn btn-secondary">Cancelar</button>
      <button type="submit" [disabled]="loading || paymentForm.invalid" class="btn btn-primary">
        <span *ngIf="loading">Procesando...</span>
        <span *ngIf="!loading">Confirmar Pago</span>
      </button>
    </div>
  </form>
</div>