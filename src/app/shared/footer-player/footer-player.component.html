<footer *ngIf="playerService.hasTrack()" class="player-footer">
  <!-- Barra de progreso (top border) -->
  <input
    type="range"
    class="song-progress"
    [value]="playerService.progress()"
    (click)="onProgressClick($event)"
    min="0"
    max="100"
  />

  <div class="footer-components">
    <!-- Sección 1: Info de la canción -->
    <section class="song-info">
      <div
        class="cover-thumbnail"
        (click)="toggleCover()"
        [style.cursor]="'pointer'"
      >
        <img [src]="playerService.currentTrack()!.coverImage" [alt]="playerService.currentTrack()!.title">
      </div>
      <div class="track-details">
        <span class="track-title">{{ playerService.currentTrack()!.title }}</span>
        <div class="track-meta">
          <span class="track-album" *ngIf="playerService.currentTrack()!.album">
            <i class="far fa-clock"></i> {{ playerService.currentTrack()!.album }}
          </span>
          <span class="track-artist">{{ playerService.currentTrack()!.artist }}</span>
        </div>
      </div>
      <!-- Botón de compartir -->
      <button class="btn-share" (click)="shareTrack()" aria-label="Compartir">
        <img src="assets/img/icons/share.svg" alt="Compartir">
      </button>
    </section>

    <!-- Modal de compartir -->
    <div class="share-modal-overlay" *ngIf="showShareModal" (click)="closeShareModal()">
      <div class="share-modal" (click)="$event.stopPropagation()">
        <h3 class="share-title">Compartir en</h3>
        <div class="share-options">
          <button class="share-option" (click)="shareOn('facebook')">
            <i class="fab fa-facebook"></i>
            <span>Facebook</span>
          </button>
          <button class="share-option" (click)="shareOn('twitter')">
            <i class="fab fa-twitter"></i>
            <span>Twitter</span>
          </button>
          <button class="share-option" (click)="shareOn('whatsapp')">
            <i class="fab fa-whatsapp"></i>
            <span>WhatsApp</span>
          </button>
          <button class="share-option" (click)="shareOn('telegram')">
            <i class="fab fa-telegram"></i>
            <span>Telegram</span>
          </button>
          <button class="share-option" (click)="shareOn('instagram')">
            <i class="fab fa-instagram"></i>
            <span>Instagram</span>
          </button>
        </div>
      </div>
    </div>

    <!-- Sección 2: Controles de reproducción -->
    <section class="player-controls">
      <!-- Volumen -->
      <button class="control-btn" aria-label="Volumen">
        <img 
          *ngIf="playerService.volume() > 50" 
          src="assets/img/icons/vol-up.svg" 
          alt="Volumen alto"
        >
        <img 
          *ngIf="playerService.volume() > 0 && playerService.volume() <= 50" 
          src="assets/img/icons/vol-down.svg" 
          alt="Volumen bajo"
        >
        <img 
          *ngIf="playerService.volume() === 0" 
          src="assets/img/icons/vol-down.svg" 
          alt="Volumen silenciado"
          style="opacity: 0.5"
        >
      </button>
      <input
        type="range"
        class="volume-slider"
        [value]="playerService.volume()"
        (input)="onVolumeChange($event)"
        min="0"
        max="100"
      />

      <!-- Agregar a playlist -->
      <button class="control-btn" (click)="addToPlaylist()" aria-label="Agregar a playlist">
        <img src="assets/img/icons/add-list.svg" alt="Agregar a playlist">
      </button>

      <!-- Anterior -->
      <button class="control-btn" (click)="previousTrack()" aria-label="Anterior">
        <img src="assets/img/icons/previus-song-icon.svg" alt="Anterior">
      </button>

      <!-- Play/Pause -->
      <button class="control-btn control-btn-primary" (click)="togglePlayPause()" aria-label="Play/Pause">
        <img 
          *ngIf="!playerService.isPlaying()" 
          src="assets/img/icons/icon_play_tracks.svg" 
          alt="Reproducir"
        >
        <img 
          *ngIf="playerService.isPlaying()" 
          src="assets/img/icons/icon_pause.svg" 
          alt="Pausar"
        >
      </button>

      <!-- Siguiente -->
      <button class="control-btn" (click)="nextTrack()" aria-label="Siguiente">
        <img src="assets/img/icons/next-song-icon.svg" alt="Siguiente">
      </button>

      <!-- Shuffle -->
      <button
        class="control-btn"
        [class.active]="playerService.isShuffle()"
        (click)="toggleShuffle()"
        aria-label="Aleatorio"
      >
        <img 
          *ngIf="!playerService.isShuffle()" 
          src="assets/img/icons/suffle-none.svg" 
          alt="Aleatorio desactivado"
        >
        <img 
          *ngIf="playerService.isShuffle()" 
          src="assets/img/icons/suffle-focus.svg" 
          alt="Aleatorio activado"
        >
      </button>

      <!-- Repeat -->
      <button
        class="control-btn"
        [class.active]="playerService.repeatMode() !== 'none'"
        (click)="toggleRepeat()"
        aria-label="Repetir"
      >
        <img 
          *ngIf="playerService.repeatMode() === 'none'" 
          src="assets/img/icons/reapeat-none.svg" 
          alt="Sin repetir"
        >
        <img 
          *ngIf="playerService.repeatMode() === 'one'" 
          src="assets/img/icons/reapeat-one.svg" 
          alt="Repetir una"
        >
        <img 
          *ngIf="playerService.repeatMode() === 'all'" 
          src="assets/img/icons/reapeat-all.svg" 
          alt="Repetir todas"
        >
      </button>
    </section>

    <!-- Sección 3: Reacciones y controles de vista -->
    <section class="player-reactions">
      <!-- Like -->
      <button
        class="reaction-btn"
        [class.liked]="playerService.currentTrack()!.isLiked"
        (click)="toggleLike()"
        aria-label="Me gusta"
      >
        <i class="fas fa-heart"></i>
        <span>{{ playerService.currentTrack()!.likes }}</span>
      </button>

      <!-- Comentarios -->
      <button
        class="reaction-btn"
        [class.active]="playerService.showCommentsSidebar()"
        (click)="toggleComments()"
        aria-label="Comentarios"
      >
        <img src="assets/img/icons/comment-icon.svg" alt="Comentarios">
        <span>{{ playerService.currentTrack()!.comments }}</span>
      </button>

      <!-- Playlist/Cola -->
      <button
        class="reaction-btn reaction-btn-outline"
        [class.active]="playerService.showPlaylistSidebar()"
        (click)="togglePlaylist()"
        aria-label="Lista de reproducción"
      >
        <img src="assets/img/icons/icon_list_white.svg" alt="Lista de reproducción">
        <span>{{ playerService.queue().length }}</span>
      </button>

      <!-- Tiempos -->
      <span class="time-current">{{ formatTime(playerService.currentTime()) }}</span>
      <span class="time-divider">/</span>
      <span class="time-duration">{{ getFormattedDuration() }}</span>
    </section>
  </div>
</footer>
